# hh-hw-architecture

### Q: Представим, что у нас есть данные, которые мы очень часто читаем по сравнению с другими(например словарь стран). Как можно это оптимизировать?

A:
- Многие СУБД (если речь идет про БД), уже имеют встроенные инструменты для оптимизации считывания баз данных. 
  Например кэширование запросов.
- Для оптимизации можно использовать in-memory хранилище, тогда скорость не будет ограничена жестким диском или сетью.
- Словарь конечно можно захардкодить, но надо ли :)

### Q: Что можно сделать, если таблица вакансий стала слишком большой? Какие есть решения на уровне текущей базы данных? Можно ли ее чем то заменить?

A:
- Горизонтальное и вертикальное секционирование таблицы, по активности вакансий, дате или местоположению. 
  Это позволит распределить нагрузку и сократить время ответа на запрос. Правда, к сожалению, Postgres
  не поддерживает автоматическую фрагментацию (шардинг) данных, но можно конечно и вручную или использовать например Citus.
- Использовать чистку, `VACUUM` в Postgres, так-как при удалении или обновлении строк,
  могли остаться пустые кортежи.

### Q: Какие вы видите узкие места, возможно неправильно выбранные технологии в текущей схеме(можно рассмотреть как “нашу” схему, так и схему настоящего hh.ru)

A:

*Наша схема:*
- Mobile Api не разделен на Android и IOS.
- app нужно разделить на микросервисы 
  - плюсы:
    - получаем высокую отказоустойчивость, так-как если отваливается один из сервисов, остальные продолжают работать
    - можно легче внедрять новые фичи и дополнять сервис, не боясь поломать всю систему
  - минусы:
    - требуется построение грамотной коммуникации между сервисами
    - сложнее тестировать, нужно сначала протестировать каждый сервис, а потом тестировать его взаимодействие с другими
    сервисами
- У нас только один slave (реплика) бд и один master, для большей надежности и отказоустойчивости, лучше использовать
  побольше слейвов (реплик). Так мы сможем одну из реплик сделать мастером, в случае отказа основного мастера и при этом
  все равно иметь реплику.
- Воркер напрямую идет в реплику, можно поставить балансер между репликами и воркером, чтобы не тормозить скорость запросов.
